"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[650],{48650:function(e,n,r){r.r(n),r.d(n,{default:function(){return Z}});var t=r(1413),i=r(42982),a=r(15861),c=r(70885),s=r(87757),o=r.n(s),d=r(72791),l=r(78274),u=r(34181),f=r(15383),p=r(2144),h=r(80184),x=function(e){var n=e.dataArray,r=e.modifiedData,t=e.checked,i=(0,l.bN)(),a=(i.orders,i.user,i.transactions,i.servicesAll,i.activeChain,i.openTradeModal),c=i.setTradeModalContent,s=i.openCancelOrderModal,o=i.setCancelOrderModalContent,d=i.service,x=i.services,v=(i.agent,i.agents,function(e){var r=n.filter((function(n){return n._id===e._id}));if(Array.isArray(r)&&r.length)return r[0].price.toString()});return(0,h.jsx)(u.jM,{data:r,onClick:function(e){return function(e){var n=x.filter((function(n){return n._id==e.service&&"MARKET"==n.state}));console.log(e),0==n.length&&e.service!=d._id&&e.serviceType!=d.type?(c(e),a()):n&&e.service!=d._id&&e.serviceType!=d.type&&(o(e),s())}(e.data)},onMouseEnter:function(e,n){return function(e,n){e.serviceType!==d.type?n.target.style.cursor="pointer":(e.service,d._id,n.target.style.cursor="not-allowed")}(e.data,n)},keys:t?["serviceDuration"]:["price"],indexBy:"providerName",borderRadius:"8px",borderWidth:"1px",margin:{top:10,right:20,bottom:50,left:70},padding:.25,valueScale:{type:"symlog"},theme:{fontSize:14,fontFamily:"Roboto, sans-serif",axis:{legend:{text:{fontSize:"16px",fontWeight:"bold",fontFamily:"Roboto, sans-serif"}}}},colors:function(e){return e.data.color},borderColor:{from:"color",modifiers:[["darker",1.6]]},axisTop:null,axisRight:null,axisBottom:{tickSize:5,tickPadding:5,tickRotation:0},axisLeft:{tickSize:5,tickPadding:5,tickRotation:0,legend:t?"TIME FOR SERVICE":"PRICE",legendPosition:"middle",legendOffset:-50,tickValues:3},tooltip:function(e){var n=e.data;return(0,h.jsxs)(p.Z,{style:{opacity:"0.8"},children:[(0,h.jsxs)("b",{children:["Price: ",v(n)]}),(0,h.jsxs)("b",{children:["Time for service: ",n.serviceDuration," seconds"]})]})},label:function(e){return function(e){var r=n.filter((function(n){return n._id===e._id}));if(Array.isArray(r)&&r.length)return t?r[0].serviceDuration:r[0].price.toString()+""}(e.data)},labelSkipWidth:12,labelSkipHeight:12,labelTextColor:"white",animate:!1,motionStiffness:90,motionDamping:15,defs:[(0,f.Qr)("dots",{color:"black",background:"inherit",size:"8",padding:"4",stagger:!0}),(0,f.l0)("lines-pattern",{spacing:10,rotation:-55,lineWidth:2,background:"inherit",color:"#000000"}),(0,f.wU)("squares",{background:"inherit"}),{id:"custom",type:"patternSquares",size:24}],fill:[{match:function(e){return e.data.data.service==d._id},id:"lines-pattern"}]})},v=r(67842),g=function(e){return(0,h.jsxs)("div",{className:"d-flex",style:{padding:"5px"},children:[(0,h.jsx)("div",{style:{margin:"auto 10px auto 10px"},children:"Price"}),(0,h.jsx)(v.Z,{onChange:function(n){e.onChange(n)},checked:e.checked,onColor:"#86d3ff",onHandleColor:"#2693e6",handleDiameter:30,uncheckedIcon:!1,checkedIcon:!1,boxShadow:"0px 1px 5px rgba(0, 0, 0, 0.6)",activeBoxShadow:"0px 0px 1px 10px rgba(0, 0, 0, 0.2)",height:20,width:48,className:"react-switch"}),(0,h.jsx)("div",{className:"toggle-switch-text",children:"Time"})]})},m=r(99410),y=r(74292),b=r(43360),j=r(96209),k=function(){var e=(0,l.bN)(),n=e.transactions,r=(e.user,e.isTradeModalOpen),i=e.usersBalances,s=(e.closeTradeModal,e.servicesAll),u=e.activeChain,f=e.tradeModalContent,p=e.setIsTradeModalOpen,x=e.apiUserBidOrder,v=e.users,g=(e.orders,e.chains),k=(e.cookies,e.agents),C=e.note,w=e.setNote,Z=(0,d.useState)("0"),N=(0,c.Z)(Z,2),E=N[0],S=N[1],T=(0,d.useState)([]),A=(0,c.Z)(T,2),M=A[0],I=A[1],O=(0,d.useState)(""),D=(0,c.Z)(O,2),R=(D[0],D[1],function(){var e=(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,void 0!==E&&""!==E){e.next=5;break}w((function(e){return(0,t.Z)((0,t.Z)({},e),{},{msg:"You must enter a value",show:!0,heading:"Error",type:"danger"})})),e.next=23;break;case 5:if(!(isNaN(E)||E<0)){e.next=9;break}w((function(e){return(0,t.Z)((0,t.Z)({},e),{},{msg:"Input value must be an integer",show:!0,heading:"Error",type:"danger"})})),e.next=23;break;case 9:if(n=E,!((Math.floor(n).toString()===n?0:n.toString().split(".")[1].length||0)>0)){e.next=13;break}w((function(e){return(0,t.Z)((0,t.Z)({},e),{},{msg:"Input value must be an integer",heading:"Error",show:!0,type:"danger"})})),e.next=23;break;case 13:if(!(parseInt(f.price+parseInt(E))>parseInt(i["".concat(g[u].name)]))){e.next=17;break}w((function(e){return(0,t.Z)((0,t.Z)({},e),{},{msg:"Price and TxFee is higher than balance",heading:"Error",show:!0,type:"danger"})})),e.next=23;break;case 17:return console.log(f),e.next=20,x(E,f._id);case 20:p(!1),w((0,t.Z)({},C.show=!1)),S();case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(0),void 0!==e.t0.response&&e.t0.response.data.message;case 28:case"end":return e.stop()}var n}),e,null,[[0,25]])})));return function(){return e.apply(this,arguments)}}());(0,d.useEffect)((function(){console.log(s),console.log(n);var e=function(){var e=(0,a.Z)(o().mark((function e(){var r,t,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.filter((function(e){return e.chain==g[u].id&&e.to==f.agentAccount&&"SEND"==e.state}));case 2:return r=e.sent,e.next=5,r.sort((function(e,n){return n.fee-e.fee}));case 5:return t=e.sent,e.next=8,Promise.all(t.map(function(){var e=(0,a.Z)(o().mark((function e(n){var r,t,i,a,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.from,t=n.fee,i=n.amount,e.next=3,k.filter((function(e){return e.account===r}));case 3:return a=e.sent,e.next=6,v.users.filter((function(e){return e.id===a[0].user}));case 6:return c=e.sent,console.log(c),e.abrupt("return",{id:n._id,consumer:c[0].name,provider:f.providerName,price:i,fee:t});case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 8:i=e.sent,console.log(i),I(i);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[n,f]);var P=function(){var e=(0,a.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{"Enter"===n.key&&R()}catch(r){console.log(r)}case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,h.jsx)("div",{children:r?(0,h.jsx)("div",{className:"modal-confirm-overlay show-modal-confirm",children:(0,h.jsx)(j.E.div,{className:"box",initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},transition:{duration:.2,type:"spring",bounce:.5,ease:[0,.71,.2,1.01]},children:(0,h.jsxs)("div",{className:"modal-confirm-container",children:[(0,h.jsxs)("h3",{children:["Bid for ",(0,h.jsxs)("span",{style:{color:"orange"},children:[" ","".concat(f.providerName,"'s")]}),"  service"]}),(0,h.jsxs)("div",{className:"modal-confirm-container-data",children:[(0,h.jsxs)("div",{className:"modal-confirm-container-input",children:[(0,h.jsxs)("ul",{children:[(0,h.jsxs)("li",{style:{textAlign:"center"},children:[" ",(0,h.jsxs)("span",{style:{color:function(e){switch(e){case"MECHANICAL":return"#db6d28";case"ELECTRICAL":return"#388bfd";case"PROGRAMMING":return"#a371f7";default:return"rgb(0, 0, 0)"}}(f.serviceType)},children:[" ",f.serviceType," "]}),"  "]}),(0,h.jsxs)("li",{children:[" Price: ",(0,h.jsxs)("span",{style:{color:"green"},children:[" ",f.price," "]})," "]})]}),(0,h.jsxs)("div",{className:"trade-modal-input-group",children:[(0,h.jsx)("label",{htmlFor:"txFee",children:"Tx Fee"}),(0,h.jsx)("div",{className:"trade-modal-input-group-container",children:(0,h.jsx)(m.Z,{children:(0,h.jsx)(y.Z,{value:E,placeholder:"Enter tx fee",onChange:function(e){return S(e.target.value)},onKeyPress:function(e){return P(e)}})})})]})]}),(0,h.jsx)("div",{className:"trade-modal-table-container",children:(0,h.jsxs)("table",{className:"modal-table-pending-transactions",children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{className:"table-pending-transactions-head",children:"No."}),(0,h.jsx)("th",{className:"table-pending-transactions-head",children:"Pending transactions"}),(0,h.jsx)("th",{className:"table-pending-transactions-head",children:"Tx Fee"})]})}),(0,h.jsx)("tbody",{children:M.map((function(e,n){return(0,h.jsxs)("tr",{"data-tip":!0,"data-for":e.id,children:[(0,h.jsx)("td",{children:(0,h.jsx)("strong",{children:n+1})}),(0,h.jsxs)("td",{children:[e.consumer," \u21c6 ",e.provider]}),(0,h.jsx)("td",{children:e.fee})]},e.id)}))})]})})]}),(0,h.jsxs)("div",{className:"d-flex",children:[(0,h.jsx)(b.Z,{class:"btn btn-success active",style:{backgroundColor:"green",margin:"1rem"},className:"confirm-modal-btn",onClick:R,children:"Confirm"}),(0,h.jsx)(b.Z,{class:"btn btn-danger",style:{backgroundColor:"red",margin:"1rem"},onClick:function(){p(!1),w((0,t.Z)({},C.show=!1)),S()},children:"Cancel"})]})]})})}):(0,h.jsx)("div",{})})},C=r(56355),w=function(){var e=(0,d.useContext)(l.Il),n=function(){var n=(0,a.Z)(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,console.log(e.cancelOrderModalContent.id),n.next=4,e.apiUserCancelOrder(e.cancelOrderModalContent.id);case 4:e.closeCancelOrderModal(),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.log(n.t0);case 10:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(){return n.apply(this,arguments)}}(),r=function(e){try{"Enter"===e.key&&n()}catch(r){console.log(r)}};return(0,d.useEffect)((function(){return document.addEventListener("keydown",(function(e){return r(e)})),function(){document.removeEventListener("keydown",(function(e){return r(e)}))}}),[e.cancelOrderModalContent]),(0,h.jsx)("div",{children:e.isCancelOrderModalOpen?(0,h.jsxs)("div",{children:["CANCEL ORDER MODAL",(0,h.jsx)("div",{className:"modal-confirm-overlay show-modal-confirm",children:(0,h.jsx)(j.E.div,{className:"box",initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},transition:{duration:.2,type:"spring",bounce:.5,ease:[0,.71,.2,1.01]},children:(0,h.jsxs)("div",{className:"modal-confirm-container",children:[(0,h.jsx)("h3",{children:"Are you sure you want to cancel offer:"}),(0,h.jsxs)("ul",{children:[(0,h.jsxs)("li",{children:["Player: ",e.cancelOrderModalContent.playerName]}),(0,h.jsxs)("li",{children:["typeOfService: ",e.cancelOrderModalContent.typeOfService]}),(0,h.jsxs)("li",{children:["price: ",e.cancelOrderModalContent.price]})]}),(0,h.jsx)("button",{className:"close-modal-btn",onClick:e.closeCancelOrderModal,children:(0,h.jsx)(C.aHS,{})}),(0,h.jsx)("button",{className:"confirm-modal-btn",onClick:n,children:"Confirm"})]})})})]}):(0,h.jsx)("div",{})})},Z=function(){var e=(0,l.bN)(),n=e.game,r=e.users,s=e.orders,u=e.agents,f=e.servicesAll,p=e.service,v=e.chains,m=e.activeChain,y=(0,d.useState)([]),b=(0,c.Z)(y,2),j=b[0],C=b[1],Z=(0,d.useState)([]),N=(0,c.Z)(Z,2),E=N[0],S=N[1],T=(0,d.useState)([]),A=(0,c.Z)(T,2),M=A[0],I=A[1],O=(0,d.useState)([]),D=(0,c.Z)(O,2),R=D[0],P=D[1],_=(0,d.useState)([]),L=(0,c.Z)(_,2),F=L[0],z=L[1],B=(0,d.useState)([]),H=(0,c.Z)(B,2),W=H[0],G=H[1],U=(0,d.useState)(["Service1","Service2"]),q=(0,c.Z)(U,2),K=q[0],V=q[1],Q=(0,d.useState)(!1),Y=(0,c.Z)(Q,2),J=Y[0],X=Y[1],$=(0,d.useState)(!1),ee=(0,c.Z)($,2),ne=ee[0],re=ee[1],te=(0,d.useState)(!1),ie=(0,c.Z)(te,2),ae=ie[0],ce=ie[1],se="#ffffff",oe=function(e){return(e/6e4).toFixed(2)},de=function(e){switch(e){case"MECHANICAL":return"#db6d28";case"ELECTRICAL":return"#388bfd";case"PROGRAMMING":return"#a371f7";default:return"rgb(0, 0, 0)"}};return(0,d.useEffect)((function(){var e=function(){var e=(0,a.Z)(o().mark((function e(){var n,a,c,d,l,h,x,g,y;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.filter((function(e){return e.chain===v[m].id&&"PLACED"===e.state})),e.next=3,n.map((function(e){var n=f.filter((function(n){return n._id==e.service}));e.serviceType=n[0].type,e.serviceDuration=n[0].duration;var t=u.filter((function(e){return e._id===n[0].agent})),i=r.users.filter((function(e){return e.id===t[0].user}));return console.log(t[0]),e.providerName=i[0].name,e.agentId=t[0]._id,e.agentAccount=t[0].account,e.providerId=i[0].id,e}));case 3:return a=e.sent,c=(c=(0,i.Z)(new Set(f.map((function(e){return e.type}))))).filter((function(e){return e!==p.type})),V(c),e.next=9,a.filter((function(e){return e.serviceType===c[0]}));case 9:return d=e.sent,e.next=12,a.filter((function(e){return e.serviceType===c[1]}));case 12:return l=e.sent,e.next=15,a.filter((function(e){return e.serviceType===p.type}));case 15:if(h=e.sent,!J){e.next=26;break}return e.next=19,d.forEach((function(e){e.price=parseInt(e.price),e.color=de(e.serviceType)}));case 19:return e.next=21,d.sort((function(e,n){return e.serviceDuration-n.serviceDuration}));case 21:return e.next=23,d.forEach((function(e){e.height=oe(e.serviceDuration)}));case 23:C(d),e.next=31;break;case 26:return e.next=28,d.forEach((function(e){e.price=parseInt(e.price),e.color=de(e.serviceType)}));case 28:return e.next=30,d.sort((function(e,n){return e.price-n.price}));case 30:C(d);case 31:if(!ne){e.next=41;break}return e.next=34,l.forEach((function(e){e.price=parseInt(e.price),e.color=de(e.serviceType)}));case 34:return e.next=36,l.sort((function(e,n){return e.serviceDuration-n.serviceDuration}));case 36:return e.next=38,l.forEach((function(e){e.height=oe(e.serviceDuration)}));case 38:S(l),e.next=46;break;case 41:return e.next=43,l.forEach((function(e){e.price=parseInt(e.price),e.color=de(e.serviceType)}));case 43:return e.next=45,l.sort((function(e,n){return e.price-n.price}));case 45:S(l);case 46:if(!ae){e.next=56;break}return e.next=49,h.forEach((function(e){e.price=parseInt(e.price),e.color=de(e.serviceType)}));case 49:return e.next=51,h.sort((function(e,n){return e.serviceDuration-n.serviceDuration}));case 51:return e.next=53,h.forEach((function(e){e.height=oe(e.serviceDuration)}));case 53:I(h),e.next=61;break;case 56:return e.next=58,h.forEach((function(e){e.price=parseInt(e.price),e.color=de(e.serviceType)}));case 58:return e.next=60,h.sort((function(e,n){return e.price-n.price}));case 60:I(h);case 61:return e.next=63,d.map((function(e){return e.price<1?(0,t.Z)((0,t.Z)({},e),{},{price:.9}):(0,t.Z)({},e)}));case 63:return x=e.sent,e.next=66,l.map((function(e){return e.price<1?(0,t.Z)((0,t.Z)({},e),{},{price:.9}):(0,t.Z)({},e)}));case 66:return g=e.sent,e.next=69,h.map((function(e){return e.price<1?(0,t.Z)((0,t.Z)({},e),{},{price:.9}):(0,t.Z)({},e)}));case 69:y=e.sent,P(x),z(g),G(y),console.log(y),console.log(g),console.log(x),console.log(p);case 77:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[n,J,ne,ae]),(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"d-flex flex-row flex-wrap",style:{zIndex:2},children:[(0,h.jsxs)("div",{style:{width:"35vw",maxWidth:"100%",boxShadow:"var(--light-shadow)",borderRadius:"8px",margin:"5px",background:se},children:[(0,h.jsx)("div",{style:{textAlign:"center",paddingTop:"7px"},children:(0,h.jsx)("h3",{children:K[0]})}),(0,h.jsx)(g,{checked:J,onChange:function(e){X(e)}}),(0,h.jsx)("div",{style:{height:"300px",width:"auto",margin:"auto"},children:(0,h.jsx)(x,{dataArray:j,modifiedData:R,checked:J})})]}),(0,h.jsxs)("div",{style:{width:"35vw",boxShadow:"var(--light-shadow)",borderRadius:"8px",margin:"5px",background:se},children:[(0,h.jsx)("div",{style:{textAlign:"center",paddingTop:"7px"},children:(0,h.jsx)("h3",{children:"".concat(K[1])})}),(0,h.jsx)(g,{checked:ne,onChange:function(e){re(e)}}),(0,h.jsx)("div",{style:{height:"300px",width:"auto",margin:"auto"},children:(0,h.jsx)(x,{dataArray:E,modifiedData:F,checked:ne})})]}),(0,h.jsx)("div",{children:(0,h.jsxs)("div",{style:{width:"35vw",boxShadow:"var(--light-shadow)",borderRadius:"8px",margin:"5px",background:se},children:[(0,h.jsx)("div",{style:{textAlign:"center",paddingTop:"7px"},children:(0,h.jsx)("h3",{children:"".concat(p.type)})}),(0,h.jsx)(g,{checked:ae,onChange:function(e){ce(e)}}),(0,h.jsx)("div",{style:{height:"300px",width:"auto",margin:"auto"},children:(0,h.jsx)(x,{dataArray:M,modifiedData:W,checked:ae})})]})}),(0,h.jsx)(k,{}),(0,h.jsx)(w,{})]})})}}}]);
//# sourceMappingURL=650.83df2c37.chunk.js.map