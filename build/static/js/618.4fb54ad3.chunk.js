"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[618],{6365:function(e,n,t){t.r(n),t.d(n,{default:function(){return x}});var r=t(42982),a=t(15861),s=t(70885),i=t(87757),c=t.n(i),u=t(72791),d=t.p+"static/media/balance.17e123bc85a00d631d62.png",o=t.p+"static/media/stake.4359516e6b0981d3d9da.png",l=t(78274),p=t(80184),v=function(){var e=(0,u.useContext)(l.Il),n=(0,u.useState)(0),t=(0,s.Z)(n,2),r=t[0],i=t[1],d=(0,u.useState)(0),o=(0,s.Z)(d,2),v=o[0],f=o[1];function h(e){var n=new Date(1e3*Math.round(e/1e3));return 0===n.getUTCMinutes()?n.getUTCSeconds()+"s":n.getUTCMinutes()+"min "+n.getUTCSeconds()+"s"}return function(e,n){var t=(0,u.useRef)();(0,u.useEffect)((function(){t.current=e}),[e]),(0,u.useEffect)((function(){if(null!==n){var e=setInterval((function(){t.current()}),n);return function(){return clearInterval(e)}}}),[n])}((0,a.Z)(c().mark((function n(){var t,r,a;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:"ACTIVE"===e.service.state?(t=new Date(e.service.updatedAt).getTime(),(r=Math.floor((Date.now()-t)/(1e3*e.service.duration)*100))>100&&(r=100),i(r),(a=1e3*e.service.duration-(Date.now()-t))<0&&(a=0),console.log(h(a)),f(h(a))):i(100);case 1:case"end":return n.stop()}}),n)}))),50),(0,p.jsx)(p.Fragment,{children:(0,p.jsx)("div",{className:"time-container",children:(0,p.jsxs)("div",{className:"bar-container",children:[(0,p.jsx)("div",{className:"bar-filler",style:{width:"".concat(r,"%")},children:(0,p.jsx)("span",{className:"bar-label",children:"".concat(r,"%")})}),(0,p.jsxs)("div",{className:"bottom",children:["ACTIVE"!==e.service.state?(0,p.jsxs)("p",{children:["Time for service = ",e.service.duration," s"]}):(0,p.jsxs)("p",{children:["Time left = ",v]}),(0,p.jsx)("i",{})]})]})})})},f=t(37009),h=function(e){var n=e.item,t=n.id,r=n.consumer,i=n.provider,d=n.type,o=n.updatedAt,v=n.duration,h=((0,l.bN)().gameData,(0,u.useState)(0)),x=(0,s.Z)(h,2),m=x[0],g=x[1],j=(0,u.useState)(0),w=(0,s.Z)(j,2),b=w[0],N=w[1];function C(e){var n=new Date(1e3*Math.round(e/1e3));return 0===n.getUTCMinutes()?n.getUTCSeconds()+"s":n.getUTCMinutes()+"min "+n.getUTCSeconds()+"s"}return function(e,n){var t=(0,u.useRef)();(0,u.useEffect)((function(){t.current=e}),[e]),(0,u.useEffect)((function(){if(null!==n){var e=setInterval((function(){t.current()}),n);return function(){return clearInterval(e)}}}),[n])}((0,a.Z)(c().mark((function e(){var n,t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=new Date(o).getTime(),t=function(){var e=(0,a.Z)(c().mark((function e(){var t,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=1e3*v-(Date.now()-n),e.next=3,Math.floor((Date.now()-n)/(1e3*v)*100);case 3:((r=e.sent)<0||t<0)&&(r=100,t=0),N(C(t)),g(r);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t();case 3:case"end":return e.stop()}}),e)}))),50),(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("div",{className:"service-container","data-tip":!0,"data-for":t,children:[(0,p.jsx)("p",{children:d}),(0,p.jsx)("div",{id:"divSpinner",className:"spinner-loading",children:(0,p.jsxs)("div",{className:"loading-text",children:[m,"%"]})}),(0,p.jsx)(f.Z,{id:t,place:"right",type:"dark",effect:"solid",children:(0,p.jsxs)("ul",{children:[(0,p.jsxs)("li",{children:["Consumer: ",r]}),(0,p.jsxs)("li",{children:["Provider: ",i]}),(0,p.jsxs)("li",{children:["Time left: ",b]})]})})]})})},x=function(){var e=(0,l.bN)(),n=(e.game,e.user),t=e.users,i=e.chains,f=e.cookies,x=e.activeChain,m=(e.transactions,e.servicesAll),g=e.usersBalances,j=e.usersStakes,w=(e.orders,e.services),b=e.agent,N=e.agents,C=e.service,S=(0,u.useState)(0),k=(0,s.Z)(S,2),y=k[0],T=k[1],Z=(0,u.useState)([]),A=(0,s.Z)(Z,2),E=A[0],M=A[1],U=(0,u.useState)(["Service1","Service2"]),I=(0,s.Z)(U,2),D=I[0],R=I[1],F=(0,u.useState)({num:0}),G=(0,s.Z)(F,2),O=G[0],V=G[1],z=(0,u.useState)({num:0}),P=(0,s.Z)(z,2),L=P[0],_=P[1],B=(0,u.useState)([]),H=(0,s.Z)(B,2),J=(H[0],H[1]),q="#ffffff";return(0,u.useEffect)((function(){if(i.includes("id"))if(0==i[f.activeChain].stake||void 0==i[f.activeChain].stake)T({stake:0});else{var e=(j[i[f.activeChain].name]/i[f.activeChain].stake*100).toFixed(1);T({stake:e})}else T(0);var s=function(){var e=(0,a.Z)(c().mark((function e(){var r,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.filter((function(e){return"ACTIVE"===e.state}));case 2:return r=e.sent,console.log(r),e.next=6,Promise.all(r.map(function(){var e=(0,a.Z)(c().mark((function e(r){var a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.filter((function(e){return e._id===r.agent}));case 2:return a=e.sent,console.log(a),e.next=6,t.users.filter((function(e){return e._id===a[0].user}));case 6:return s=e.sent,e.abrupt("return",{id:r._id,consumer:n.name,provider:s[0].name,type:r.type,duration:r.duration,updatedAt:r.updatedAt,state:r.state});case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 6:s=e.sent,console.log(r),M(s);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();s();var u=function(){var e=(0,a.Z)(c().mark((function e(){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.filter((function(e){return e.agent===b.id}));case 2:n=e.sent,console.log("Users service is: "+JSON.stringify(n)),J(n[0]);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();u();var d=function(){var e=(0,a.Z)(c().mark((function e(){var n,t,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(n=(0,r.Z)(new Set(m.map((function(e){return e.type}))))).filter((function(e){return e!==C.type})),R({service1:n[0],service2:n[1]}),e.next=5,w.filter((function(e){return"DONE"===e.state}));case 5:t=e.sent,a=t.filter((function(e){return e.type===n[0]})),s=t.filter((function(e){return e.type===n[1]})),V({num:a.length}),_({num:s.length});case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();d()}),[w,n,m]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"d-flex",style:{padding:"5px",columnGap:"20px",rowGap:"20px"},children:[(0,p.jsxs)("div",{className:"w-25 p-3",style:{boxShadow:"var(--light-shadow)",borderRadius:"8px",fontSize:"30px",padding:"10px",backgroundColor:q},children:[(0,p.jsx)("div",{className:"stats-image",children:(0,p.jsx)("img",{src:d,alt:"balance"})}),(0,p.jsx)("div",{className:"stats-value",children:(0,p.jsx)("p",{children:0!==Object.keys(g).length?g[x]["".concat(i[x].name)]:0})})]}),(0,p.jsxs)("div",{className:"w-100 p-3",style:{boxShadow:"var(--light-shadow)",padding:"10px",borderRadius:"8px",fontSize:"30px",background:function(e){switch(e){case"MECHANICAL":return"#f8e3a1";case"ELECTRICAL":return"rgb(255, 255, 132, 0.5)";case"PROGRAMMING":return"rgb(0, 99, 132, 0.5)";default:return"rgb(255, 255, 255)"}}(C.type)},children:[(0,p.jsx)("div",{className:"time-value",children:(0,p.jsx)("h2",{children:C.type})}),(0,p.jsx)("div",{className:"".concat("ACTIVE"!==C.state?"time-value-available":"time-value-unavailable"),children:(0,p.jsx)("h2",{children:"ACTIVE"!==C.state?"Available":"Unavailable"})}),(0,p.jsx)(v,{})]})]}),(0,p.jsxs)("div",{className:"d-flex",style:{padding:"5px",columnGap:"20px",rowGap:"20px"},children:[(0,p.jsxs)("div",{className:"w-25 p-3",style:{boxShadow:"var(--light-shadow)",borderRadius:"8px",fontSize:"30px",padding:"10px",backgroundColor:q},children:[(0,p.jsx)("div",{className:"stake-image",children:(0,p.jsx)("img",{src:o,alt:"stake"})}),(0,p.jsx)("div",{className:"stake-value",children:(0,p.jsx)("p",{children:0!==Object.keys(j).length?j["".concat(i[x].name)]:0})}),(0,p.jsx)("div",{className:"stake-value-proc",children:(0,p.jsxs)("p",{children:["(",y.stake,"%)"]})})]}),(0,p.jsxs)("div",{className:"w-100 p-3",style:{boxShadow:"var(--light-shadow)",padding:"10px",borderRadius:"8px",fontSize:"30px",backgroundColor:q},children:[(0,p.jsx)("div",{className:"upgrade-value",children:(0,p.jsxs)("h3",{children:["Number of upgrades: ",n.upgradeNumber]})}),(0,p.jsxs)("div",{className:"upgrade-container",children:[(0,p.jsx)("div",{className:"".concat(O.num>0?"upgrade-container-green":"upgrade-container-red"),children:(0,p.jsxs)("p",{children:["".concat(O.num)," \xd7 ","".concat(D.service1)]})}),(0,p.jsx)("div",{children:(0,p.jsx)("p",{children:"+"})}),(0,p.jsx)("div",{className:"".concat(L.num>0?"upgrade-container-green":"upgrade-container-red"),children:(0,p.jsxs)("p",{children:["".concat(L.num)," \xd7 ","".concat(D.service2)]})})]}),(0,p.jsx)("div",{className:"upgrade-container",children:(0,p.jsx)("div",{className:"upgrade-container-formula",children:(0,p.jsxs)("p",{children:["".concat(D.service1)," + ","".concat(D.service2)," = \u21e9 ",function(e){var n=new Date(1e3*Math.round(e/1e3));return 0===n.getUTCMinutes()?n.getUTCSeconds()+"s":n.getUTCMinutes()+"min "+n.getUTCSeconds()+"s"}(n.timeForService-n.nextTimeForService)]})})})]})]}),(0,p.jsxs)("div",{className:"services-container",children:[(0,p.jsx)("h3",{children:"Purchased Services"}),(0,p.jsx)("div",{className:"loading-services-container",children:E.map((function(e){return(0,p.jsx)(h,{item:e},e.id)}))})]})]})}}}]);
//# sourceMappingURL=618.4fb54ad3.chunk.js.map