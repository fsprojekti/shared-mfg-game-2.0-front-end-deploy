"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[348],{78348:function(e,n,t){t.r(n),t.d(n,{default:function(){return C}});var r=t(1413),s=t(15861),a=t(70885),i=t(87757),c=t.n(i),o=t(72791),u=t(78274),d=t(99410),l=t(74292),h=t(43360),x=t(24849),p=t(69398),f=(t(47185),t(80184)),m=function(e){var n=e.data,t=(0,o.useContext)(u.Il);return(0,f.jsx)(p.Y2,{data:n,margin:{top:40,right:80,bottom:80,left:80},innerRadius:.5,padAngle:.7,cornerRadius:3,activeOuterRadiusOffset:8,borderWidth:1,borderColor:{from:"color",modifiers:[["darker",.2]]},arcLinkLabelsSkipAngle:10,arcLinkLabelsTextColor:"#333333",arcLinkLabelsThickness:2,arcLinkLabelsColor:{from:"color"},arcLabelsSkipAngle:10,arcLabelsTextColor:{from:"color",modifiers:[["darker",2]]},defs:[{id:"dots",type:"patternDots",background:"inherit",color:"rgba(255, 255, 255, 0.3)",size:4,padding:1,stagger:!0},{id:"lines",type:"patternLines",background:"inherit",color:"rgba(255, 255, 255, 0.3)",rotation:-45,lineWidth:6,spacing:10}],fill:[{match:{id:t.user.name},id:"dots"}]})},g=t(37009),v=t(56355),j=function(){var e=(0,u.bN)().chainMain,n=(0,o.useState)(""),t=(0,a.Z)(n,2),r=t[0],i=t[1],d=(0,o.useState)(0),l=(0,a.Z)(d,2),h=l[0],x=l[1];function p(e){var n=new Date(1e3*Math.round(e/1e3));return 0===n.getUTCMinutes()?n.getUTCSeconds()+"s":n.getUTCMinutes()+"min "+n.getUTCSeconds()+"s"}return function(e,n){var t=(0,o.useRef)();(0,o.useEffect)((function(){t.current=e}),[e]),(0,o.useEffect)((function(){if(null!==n){var e=setInterval((function(){t.current()}),n);return function(){return clearInterval(e)}}}),[n])}((0,s.Z)(c().mark((function n(){var t,r,s;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new Date(e.miningTime).getTime();case 2:return t=n.sent,r=1e4-(Date.now()-t),n.next=6,Math.floor(100*(1-(Date.now()-t)/1e4));case 6:((s=n.sent)<0||r<0)&&(s=0,r=0),i(p(r)),x(s);case 10:case"end":return n.stop()}}),n)}))),50),(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)("div",{className:"mining-progress-container",children:[(0,f.jsxs)("div",{className:"mining-progress-flex",children:[(0,f.jsx)("p",{children:"Mining"}),(0,f.jsx)("div",{className:"mining-progress",children:(0,f.jsx)("div",{className:"mining-progress-filler",style:{width:"".concat(h,"%")}})})]}),(0,f.jsxs)("span",{className:"mining-progress-text",children:["Time left: ",r]})]})})},k=function(){var e=(0,o.useContext)(u.Il),n=e.game,t=e.user,r=e.users,i=e.agents,d=e.chainMain,l=e.openConfirmModal,h=e.setConfirmModalContent,x=e.transactions,p=e.chains,m=e.activeChain,k=(0,o.useState)([]),y=(0,a.Z)(k,2),C=y[0],b=y[1],Z=(0,o.useState)(""),w=(0,a.Z)(Z,2),N=(w[0],w[1]),S=(0,o.useState)(0),T=(0,a.Z)(S,2),I=(T[0],T[1]);function M(e){var n=new Date(1e3*Math.round(e/1e3));return 0===n.getUTCMinutes()?n.getUTCSeconds()+"s":n.getUTCMinutes()+"min "+n.getUTCSeconds()+"s"}return(0,o.useEffect)((function(){var e=function(){var e=(0,s.Z)(c().mark((function e(){var n,t,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(x[p[m].name]),e.next=3,x[p[m].name].filter((function(e){return"SEND"==e.state}));case 3:return n=e.sent,console.log(n),e.next=7,n.sort((function(e,n){return parseInt(n.fee)-parseInt(e.fee)}));case 7:return t=e.sent,console.log(t),e.next=11,Promise.all(t.map(function(){var e=(0,s.Z)(c().mark((function e(t){var s,a,o,u,d,l,h,x;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.from,a=t.to,o=t.fee,u=t.amount,console.log(s),console.log(a),e.next=5,i.filter((function(e){return e.account===s}));case 5:return d=e.sent,e.next=8,r.users.filter((function(e){return e._id===d[0].user}));case 8:return l=e.sent,e.next=11,i.filter((function(e){return e.account===n[0].to}));case 11:if(h=e.sent,console.log(0==h.length),0!=h.length){e.next=15;break}return e.abrupt("return",{id:t._id,consumer:l[0].name,provider:"Blockchain",price:u,fee:o});case 15:return e.next=17,r.users.filter((function(e){return e._id===h[0].user}));case 17:if(void 0==(x=e.sent)[0].name){e.next=20;break}return e.abrupt("return",{id:t._id,consumer:l[0].name,provider:x[0].name,price:u,fee:o});case 20:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 11:a=e.sent,b(a);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e();var n=function(){var e=(0,s.Z)(c().mark((function e(){var n,t,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Date(d.miningTime).getTime();case 2:return n=e.sent,t=1e4-(Date.now()-n),e.next=6,Math.floor(100*(1-(Date.now()-n)/1e4));case 6:((r=e.sent)<0||t<0)&&(r=0,t=0),N(M(t)),I(r);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();n()}),[n]),(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)("div",{className:"pending-transactions-container",children:[(0,f.jsx)(j,{}),(0,f.jsx)("div",{className:"table-pending-transactions-container",children:(0,f.jsxs)("table",{className:"table-pending-transactions",children:[(0,f.jsx)("thead",{children:(0,f.jsxs)("tr",{children:[(0,f.jsx)("th",{className:"table-pending-transactions-head",children:"No."}),(0,f.jsxs)("th",{className:"table-pending-transactions-head",children:["Pending transactions on ",p[m].name," chain"]}),(0,f.jsx)("th",{className:"table-pending-transactions-head",children:"Tx Fee"})]})}),(0,f.jsx)("tbody",{children:C.map((function(e,n){return(0,f.jsxs)("tr",{"data-tip":!0,"data-for":e.id,style:{background:"".concat(e.consumer===t.playerName||e.provider===t.playerName?"#fffd6c":"")},children:[(0,f.jsx)("td",{children:(0,f.jsx)("strong",{children:n+1})}),(0,f.jsxs)("td",{children:[e.consumer," \u21c6 ",e.provider,e.consumer===t.playerName?(0,f.jsx)("button",{className:"cancel-transaction-btn",onClick:function(){(e.consumer===t.playerName||e.provider===t.playerName)&&(h(e),l())},children:(0,f.jsx)(v.aHS,{})}):""]}),(0,f.jsx)("td",{children:e.fee}),(0,f.jsx)("td",{className:"table-pending-transactions-tooltip",children:(0,f.jsx)(g.Z,{id:e.id,place:"bottom",type:"dark",effect:"solid",children:(0,f.jsxs)("ul",{children:[(0,f.jsxs)("li",{children:["Consumer: ",e.consumer]}),(0,f.jsxs)("li",{children:["Provider: ",e.provider]}),(0,f.jsxs)("li",{children:["typeOfService: ",e.typeOfService]}),(0,f.jsxs)("li",{children:["price: ",e.price]})]})})})]},e.id)}))})]})})]})})},y=function(){var e=(0,o.useContext)(u.Il),n=e.game,t=(e.user,e.users),i=e.agents,d=(e.chainMain,e.openConfirmModal,e.setConfirmModalContent,e.transactions),l=e.chains,h=e.activeChain,x=(0,o.useState)([]),p=(0,a.Z)(x,2),m=p[0],g=p[1],j=(0,o.useState)("time"),k=(0,a.Z)(j,2),y=k[0],C=k[1],b=(0,o.useState)("ascending"),Z=(0,a.Z)(b,2),w=Z[0],N=Z[1],S=(0,o.useState)([{type:"Mechanical service",isChecked:!1},{type:"Electrical service",isChecked:!1},{type:"IT service",isChecked:!1},{type:"Stake",isChecked:!1},{type:"Unstake",isChecked:!1}]),T=(0,a.Z)(S,2),I=T[0],M=T[1],A=function(){var e=(0,s.Z)(c().mark((function e(n){var t,s,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.target.name,s=n.target.checked,e.next=4,I.map((function(e){return e.type===t?(0,r.Z)((0,r.Z)({},e),{},{isChecked:s}):e}));case 4:a=e.sent,M(a);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){var e=function(){var e=(0,s.Z)(c().mark((function e(){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(d[l[h].name]),e.next=3,d[l[h].name].filter((function(e){return"MINED"==e.state}));case 3:return n=e.sent,console.log(n),e.next=7,Promise.all(n.map(function(){var e=(0,s.Z)(c().mark((function e(r){var s,a,o,u,d,l,h,x,p,f,m,g,v,j;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.from,r.to,a=r.fee,o=r.amount,e.next=3,i.filter((function(e){return e.account===s}));case 3:if(u=e.sent,d="BLOCKCHAIN",!(u.length>0)){e.next=10;break}return e.next=8,t.users.filter((function(e){return e._id===u[0].user}));case 8:l=e.sent,d=l[0].name;case 10:return e.next=13,i.filter((function(e){return e.account===n[0].to}));case 13:if(h=e.sent,x="BLOCKCHAIN",void 0==s){e.next=20;break}return e.next=18,t.users.filter((function(e){return e._id===h[0].user}));case 18:p=e.sent,x=p[0].name;case 20:if(f=new Date(r.createdAt),m=f.getHours(),g=f.getMinutes(),v=f.getSeconds(),j=m+":"+g+":"+v,"SERVICE"!==r.type){e.next=28;break}return e.abrupt("return",{id:r._id,consumer:d,provider:x,price:r.amount,fee:r.fee,type:h[0].type,createdAt:j});case 28:return e.abrupt("return",{id:r._id,consumer:d,provider:x,price:o,fee:a,type:r.type,createdAt:j});case 29:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 7:r=e.sent,g(r);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[n,I,w]),(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)("div",{className:"table-all-transactions-container",children:[(0,f.jsx)("div",{className:"filter-all-transactions",children:I.map((function(e){return(0,f.jsxs)("label",{className:"checkbox-container",children:[e.type,(0,f.jsx)("input",{type:"checkbox",name:e.type,checked:e.isChecked,onChange:A}),(0,f.jsx)("span",{className:"checkmark"})]},e.type)}))}),(0,f.jsx)("div",{className:"table-all-transactions-overflow",children:(0,f.jsxs)("table",{className:"table-all-transactions",children:[(0,f.jsx)("thead",{children:(0,f.jsxs)("tr",{children:[(0,f.jsxs)("th",{onClick:function(){C("time"),"ascending"===w&&N("descending"),"descending"===w&&N("ascending")},children:["Time ","time"===y?"ascending"===w?(0,f.jsx)(v.ZTc,{}):(0,f.jsx)(v.NWQ,{}):""]}),(0,f.jsxs)("th",{onClick:function(){C("consumer"),"ascending"===w&&N("descending"),"descending"===w&&N("ascending")},children:["Consumer ","consumer"===y?"ascending"===w?(0,f.jsx)(v.ZTc,{}):(0,f.jsx)(v.NWQ,{}):""]}),(0,f.jsxs)("th",{onClick:function(){C("provider"),"ascending"===w&&N("descending"),"descending"===w&&N("ascending")},children:["Provider ","provider"===y?"ascending"===w?(0,f.jsx)(v.ZTc,{}):(0,f.jsx)(v.NWQ,{}):""]}),(0,f.jsxs)("th",{onClick:function(){C("typeOfService"),"ascending"===w&&N("descending"),"descending"===w&&N("ascending")},children:["Type of service ","typeOfService"===y?"ascending"===w?(0,f.jsx)(v.ZTc,{}):(0,f.jsx)(v.NWQ,{}):""]}),(0,f.jsxs)("th",{onClick:function(){C("price"),"ascending"===w&&N("descending"),"descending"===w&&N("ascending")},children:["Price/Amount ","price"===y?"ascending"===w?(0,f.jsx)(v.ZTc,{}):(0,f.jsx)(v.NWQ,{}):""]}),(0,f.jsxs)("th",{onClick:function(){C("txFee"),"ascending"===w&&N("descending"),"descending"===w&&N("ascending")},children:["Tx Fee ","txFee"===y?"ascending"===w?(0,f.jsx)(v.ZTc,{}):(0,f.jsx)(v.NWQ,{}):""]})]})}),(0,f.jsx)("tbody",{children:m.map((function(e){return(0,f.jsxs)("tr",{children:[(0,f.jsx)("td",{children:e.createdAt}),(0,f.jsx)("td",{children:e.consumer}),(0,f.jsx)("td",{children:e.provider}),(0,f.jsx)("td",{children:e.type}),(0,f.jsx)("td",{children:e.price}),(0,f.jsx)("td",{children:e.fee})]},e.id)}))})]})})]})})},C=function(){var e=(0,o.useContext)(u.Il),n=(0,o.useState)([]),i=(0,a.Z)(n,2),p=i[0],g=i[1],v=(0,o.useState)(0),j=(0,a.Z)(v,2),C=j[0],b=j[1],Z=(0,o.useState)("0"),w=(0,a.Z)(Z,2),N=w[0],S=w[1],T=(0,o.useState)("0"),I=(0,a.Z)(T,2),M=I[0],A=I[1],E=(0,o.useState)(!1),L=(0,a.Z)(E,2),U=L[0],R=L[1],D=(0,o.useState)(!1),W=(0,a.Z)(D,2),F=W[0],z=(W[1],function(){var n=(0,s.Z)(c().mark((function n(){var a,i,o;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.e(133).then(t.bind(t,3133)).then(function(){var n=(0,s.Z)(c().mark((function n(t){var r;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.checkNumber,n.next=3,r(M,N,e.usersBalances[e.activeChain]["".concat(e.chains[e.activeChain].name)]);case 3:a=n.sent;case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).catch((function(e){console.log(e)}));case 3:if(-1!=a.state){n.next=7;break}e.setNote((function(e){return(0,r.Z)((0,r.Z)({},e),{},{msg:a.msg,heading:"Wrong input",show:!0,type:"danger"})})),n.next=16;break;case 7:return R(!0),i={amount:N,fee:M,chainId:e.chains[e.activeChain].id},n.next=11,e.apiUserStake(e.cookies.userId,i);case 11:o=n.sent,e.setNote((function(e){return(0,r.Z)((0,r.Z)({},e),{},{msg:o,heading:"Success",show:!0,type:"success"})})),R(!1),S("0"),A("0");case 16:n.next=22;break;case 18:n.prev=18,n.t0=n.catch(0),R(!1),e.setNote({show:!0,type:"danger",msg:n.t0.response.data.message,heading:"Could not stake! "});case 22:case"end":return n.stop()}}),n,null,[[0,18]])})));return function(){return n.apply(this,arguments)}}()),O=function(){var n=(0,s.Z)(c().mark((function n(){var a,i;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.e(133).then(t.bind(t,3133)).then(function(){var n=(0,s.Z)(c().mark((function n(t){var r;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.checkNumber,n.next=3,r(M,N,e.usersBalances[e.activeChain]["".concat(e.chains[e.activeChain].name)]);case 3:a=n.sent;case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).catch((function(e){console.log(e)}));case 3:if(-1!=a.state){n.next=7;break}e.setNote((function(e){return(0,r.Z)((0,r.Z)({},e),{},{msg:a.msg,heading:"Wrong input",show:!0,type:"danger"})})),n.next=16;break;case 7:return R(!0),i={amount:N,fee:M,chainId:e.chains[e.activeChain].id},n.next=11,e.apiUserUnstake(e.cookies.userId,i);case 11:n.sent,e.setNote((function(e){return(0,r.Z)((0,r.Z)({},e),{},{msg:"Sussessfully staked",heading:"Success",show:!0,type:"success"})})),R(!1),S("0"),A("0");case 16:n.next=22;break;case 18:n.prev=18,n.t0=n.catch(0),R(!1),e.setNote({show:!0,type:"danger",msg:n.t0.response.data.message,heading:"Could not unstake! "});case 22:case"end":return n.stop()}}),n,null,[[0,18]])})));return function(){return n.apply(this,arguments)}}();return(0,o.useEffect)((function(){"NULL"!==e.chains[0].name?0==e.chains[e.cookies.activeChain].stake||void 0==e.chains[e.cookies.activeChain].stake?b(0):b((e.usersStakes[e.chains[e.cookies.activeChain].name]/e.chains[e.cookies.activeChain].stake*100).toFixed(1)):b(0);var n=function(){var n=(0,s.Z)(c().mark((function n(){var t;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.users.users.map((function(e){return{id:e.name,label:e.name,value:e.stake}}));case 2:t=n.sent,g(t),console.log(t);case 5:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();n()}),[e.users]),(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)("div",{className:"d-flex flex-column",style:{padding:"5px"},children:[(0,f.jsxs)("div",{className:"d-flex",children:[(0,f.jsx)(k,{}),(0,f.jsxs)("div",{className:"d-flex flex-column align-items-center justify-content-center",style:{width:"100%",margin:"5px",justifyContent:"space-evenly",borderRadius:"8px",boxShadow:"var(--light-shadow)",paddingRight:"5px",zIndex:1},children:[(0,f.jsxs)("div",{className:"d-flex flex-column",style:{textAlign:"center",paddingTop:"7px"},children:[(0,f.jsxs)("h3",{children:[" Stake on ",(0,f.jsxs)("span",{style:{color:"red"},children:[" ",e.chains[e.cookies.activeChain].name," "]})," Chain "]}),(0,f.jsxs)("h4",{children:["Your stake: ",e.usersStakes[e.chains[e.cookies.activeChain].name]," (",C,"%)"]})]}),(0,f.jsxs)("div",{className:"d-flex",style:{width:"100%",height:"100%",minWidth:"20%"},children:[(0,f.jsx)("div",{style:{margin:"auto",width:"35vh",height:"30vh"},children:(0,f.jsx)(m,{data:p})}),(0,f.jsxs)("div",{className:"d-flex flex-column",style:{justifyContent:"center",alignItems:"center",zIndex:1},children:[(0,f.jsxs)(d.Z,{style:{paddingBottom:"15px"},children:[(0,f.jsx)(d.Z.Text,{id:"d-flex",style:{fontSize:"1.2rem",borderRadius:"8px 0 0 8px"},children:"Amount"}),(0,f.jsx)(l.Z,{value:N,placeholder:"Enter amount",onChange:function(e){return S(e.target.value)},style:{borderRadius:"0px 8px 8px 0"}})]}),(0,f.jsxs)(d.Z,{style:{paddingBottom:"15px"},children:[(0,f.jsx)(d.Z.Text,{id:"d-flex",style:{fontSize:"1.2rem",borderRadius:"8px 0 0 8px"},children:"Fee"}),(0,f.jsx)(l.Z,{value:M,placeholder:"Enter amount",onChange:function(e){return A(e.target.value)},style:{borderRadius:"0px 8px 8px 0"}})]}),(0,f.jsx)(h.Z,{variant:"success",onClick:z,style:{padding:"0.3rem 2rem",margin:"5px",fontSize:"1.2rem",borderRadius:"8px"},children:U?(0,f.jsxs)("div",{children:[(0,f.jsx)(x.Z,{as:"span",animation:"grow",size:"sm",role:"status","aria-hidden":"true"}),(0,f.jsx)("text",{children:" STAKE  "})]}):(0,f.jsx)("text",{children:" STAKE  "})}),(0,f.jsx)(h.Z,{variant:"warning",onClick:O,style:{padding:"0.3rem 1.2rem",margin:"5px",fontSize:"1.2rem",borderRadius:"8px"},children:F?(0,f.jsxs)("div",{children:[(0,f.jsx)(x.Z,{as:"span",animation:"grow",size:"sm",role:"status","aria-hidden":"true"}),(0,f.jsx)("text",{children:" UNSTAKE  "})]}):(0,f.jsx)("text",{children:" UNSTAKE  "})})]})]})]})]}),(0,f.jsxs)("div",{style:{backgroundColor:"rgba(255, 255, 255, 0.8)",boxShadow:"var(--light-shadow)",borderRadius:"8px",margin:"5px",textAlign:"center"},children:[(0,f.jsx)("h3",{children:"Transactions History"}),(0,f.jsx)(y,{})]})]})})}}}]);
//# sourceMappingURL=348.6a1078fe.chunk.js.map